# ç¬¬3å›ï¼šDiscord Bot åˆå°å…¥ + SQLite åŸºç¤

ãƒ¡ãƒ³ã‚¿ãƒ«ç³»ã‚µãƒ¼ãƒãƒ¼ã§ä½¿ã†ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ã€æœ€å°æ§‹æˆã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

---

## ğŸ“Œ ã“ã®å›ã®ç›®æ¨™

- Discord Bot ã‚’å®Ÿéš›ã«ã‚µãƒ¼ãƒãƒ¼ã«å°å…¥ã™ã‚‹
- `/hello` ã‚³ãƒãƒ³ãƒ‰ã§ Bot ãŒåå¿œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹
- SQLite ã§ãƒ‡ãƒ¼ã‚¿ã‚’1ã¤ã ã‘è¨˜éŒ²ãƒ»èª­ã¿å‡ºã—ã§ãã‚‹

**ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆï¼š**
- è¤‡é›‘ãªæ©Ÿèƒ½ã¯ä½œã‚Šã¾ã›ã‚“
- ã€ŒBot ãŒå‹•ãã€ã€Œãƒ‡ãƒ¼ã‚¿ãŒæ®‹ã‚‹ã€ã“ã®2ã¤ã ã‘ã‚’ä½“é¨“ã—ã¾ã™

---

## ğŸ¯ å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: /hello
Bot: ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã† ğŸ˜Š

ãƒ¦ãƒ¼ã‚¶ãƒ¼: /save ãŠã¯ã‚ˆã†
Bot: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ

ãƒ¦ãƒ¼ã‚¶ãƒ¼: /read
Bot: è¨˜éŒ²ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ãŠã¯ã‚ˆã†
```

**ğŸ‘‰ ãŸã£ãŸã“ã‚Œã ã‘ã§ã™ãŒã€ã“ã‚ŒãŒå…¨ã¦ã®åŸºç¤ã§ã™**

---

## ğŸ“š äº‹å‰æº–å‚™

### å¿…è¦ãªã‚‚ã®

- âœ… Node.js ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… Git ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… VS Code ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… Discord ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- âœ… ç¬¬2å›ã§ä½œæˆã—ãŸ `git_practice` ãƒ•ã‚©ãƒ«ãƒ€

---

## ç¬¬1ç« ï¼šDiscord Bot ã®æº–å‚™ï¼ˆ10åˆ†ï¼‰

### 1-1. Discord Developer Portal ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆ

1. [Discord Developer Portal](https://discord.com/developers/applications) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **New Application** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. åå‰ã‚’å…¥åŠ›ï¼ˆä¾‹: `mental-support-bot`ï¼‰
4. **Create** ã‚’ã‚¯ãƒªãƒƒã‚¯

---

### 1-2. Bot ã‚’ä½œæˆã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—

1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® **Bot** ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **Reset Token** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **Yes, do it!** ã§ç¢ºèª
4. è¡¨ç¤ºã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ **ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜**

**âš ï¸ è¶…é‡è¦ï¼š**
- ã“ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¯ **çµ¶å¯¾ã«ä»–äººã«è¦‹ã›ãªã„**
- GitHub ã« **çµ¶å¯¾ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãªã„**
- ç´›å¤±ã—ãŸã‚‰å†ç™ºè¡ŒãŒå¿…è¦

---

## ğŸ”§ 1-3. Bot ã® Gateway Intents ã‚’æœ‰åŠ¹åŒ–ï¼ˆé‡è¦ï¼‰

> âš ï¸ **ã“ã®è¨­å®šã‚’ã—ãªã„ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãã¦ã‚‚ Bot ã¯èµ·å‹•æ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™**

1. Discord Developer Portal ã§ã€ä½œæˆã—ãŸ **ã‚¢ãƒ—ãƒª** ã‚’é–‹ã
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® **Bot** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ç”»é¢ã‚’ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦
   **Privileged Gateway Intents** ã‚’æ¢ã™
4. ä»¥ä¸‹ã‚’ **ON** ã«ã™ã‚‹ï¼š

   * âœ… **Message Content Intent**
5. å³ä¸‹ã® **Save Changes** ã‚’ã‚¯ãƒªãƒƒã‚¯

ğŸ“Œ è£œè¶³ï¼š

* ã“ã®è¨­å®šã¯ **æ‹›å¾…URLï¼ˆOAuth2ï¼‰ã¨ã¯åˆ¥ç‰©**
* Bot ãŒ **Discordã¨æ¥ç¶šã™ã‚‹æ™‚ç‚¹ã§è¨±å¯ã•ã‚Œã‚‹ã‹ã©ã†ã‹**ã«é–¢ä¿‚ã™ã‚‹
* `GatewayIntentBits.MessageContent` ã‚’ä½¿ã†ã‚³ãƒ¼ãƒ‰ã§ã¯ **å¿…é ˆ**

---

### 1-4. Bot ã«æ¨©é™ã‚’è¨­å®š

1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® **OAuth2 â†’ URL Generator**
2. **SCOPES** ã§ `bot` ã¨ `applications.commands` ã«ãƒã‚§ãƒƒã‚¯
3. **BOT PERMISSIONS** ã§ä»¥ä¸‹ã«ãƒã‚§ãƒƒã‚¯:
   - Send Messages
   - Read Message History
   - Use Slash Commands

4. ç”Ÿæˆã•ã‚ŒãŸ URL ã‚’ã‚³ãƒ”ãƒ¼

---

## 1-5. Bot ã‚’ã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…ï¼ˆå¤‰æ›´ãªã—ï¼‰

1. ç”Ÿæˆã•ã‚ŒãŸ URL ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
2. ã‚µãƒ¼ãƒãƒ¼ã‚’é¸æŠ
3. **èªè¨¼** ã‚’ã‚¯ãƒªãƒƒã‚¯

**âœ… Bot ãŒã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã™ã‚Œã°æˆåŠŸã§ã™**

---

## ãªãœã“ã®é …ç›®ãŒå¿…è¦ã‹ï¼ˆçŸ­ãç†è§£ç”¨ï¼‰

* **BOT PERMISSIONS**
  â†’ ã‚µãƒ¼ãƒãƒ¼å†…ã§ã€Œä½•ãŒã§ãã‚‹ã‹ã€ï¼ˆé€ä¿¡ãƒ»å±¥æ­´ãƒ»ã‚³ãƒãƒ³ãƒ‰ï¼‰
* **Privileged Gateway Intents**
  â†’ Discordã‹ã‚‰ã€Œã©ã‚“ãªæƒ…å ±ã‚’å—ã‘å–ã£ã¦ã„ã„ã‹ã€

---

## ç¬¬2ç« ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆ10åˆ†ï¼‰

### 2-1. ä½œæ¥­ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•

```bash
cd git_practice
```

---

### 2-2. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install discord.js better-sqlite3 dotenv
```

**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚‚ã®ï¼š**
- `discord.js` â†’ Discord Bot ã‚’ä½œã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- `better-sqlite3` â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteï¼‰ã‚’ä½¿ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

---

### 2-3. .env ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜

```bash
echo DISCORD_TOKEN=ã‚ãªãŸã®ãƒˆãƒ¼ã‚¯ãƒ³ > .env
```

**âš ï¸ æ³¨æ„ï¼š**
- `ã‚ãªãŸã®ãƒˆãƒ¼ã‚¯ãƒ³` ã®éƒ¨åˆ†ã‚’å®Ÿéš›ã®ãƒˆãƒ¼ã‚¯ãƒ³ã«ç½®ãæ›ãˆã¦ãã ã•ã„
- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `.gitignore` ã«æ—¢ã«å«ã¾ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™

**ç¢ºèªæ–¹æ³•ï¼š**
```bash
cat .gitignore
```

æ¬¡ã®å†…å®¹ãŒå«ã¾ã‚Œã¦ã„ã‚Œã°OKï¼š
```
node_modules
.env
```

---

## ç¬¬3ç« ï¼šæœ€åˆã® Bot ã‚³ãƒ¼ãƒ‰ï¼ˆ15åˆ†ï¼‰

### 3-1. index.js ã‚’ä½œæˆ

VS Code ã§ `git_practice/index.js` ã‚’æ–°è¦ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¾ã™ï¼š

```javascript
// .env ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚€
require('dotenv').config();
const { Client, GatewayIntentBits } = require('discord.js');

// Bot ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆ
const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ]
});

// Bot ãŒèµ·å‹•ã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹
client.once('ready', () => {
  console.log(`${client.user.tag} ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼`);
});

// Discord ã«ãƒ­ã‚°ã‚¤ãƒ³
client.login(process.env.DISCORD_TOKEN);
```

**ä¿å­˜ï¼ˆCtrl + Sï¼‰ã—ã¦ãã ã•ã„**

---

### 3-2. Bot ã‚’èµ·å‹•ã—ã¦ã¿ã‚‹

```bash
node index.js
```

**æˆåŠŸã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼š**
```
YourBot#1234 ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼
```

**âœ… ã“ã‚Œã§ Bot ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«ãªã‚Šã¾ã—ãŸï¼**

Discord ã‚µãƒ¼ãƒãƒ¼ã‚’è¦‹ã‚‹ã¨ã€Bot ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚

**åœæ­¢æ–¹æ³•ï¼š**
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `Ctrl + C`

---

## ç¬¬4ç« ï¼š/hello ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè£…ï¼ˆ15åˆ†ï¼‰

### 4-1. ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ

## 4-1. ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆï¼ˆé‡è¦ï¼‰

> âš ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ `commands` ã‚’ **ã‚ã¨ã‹ã‚‰ã€Œè¿½åŠ ã€ã™ã‚‹ç« ãŒã‚ã‚Šã¾ã™**  
> ãã®ãŸã‚ã€ã“ã®æ™‚ç‚¹ã§ã¯ **ã²ãªå½¢ã¨ã—ã¦ä½œæˆ**ã—ã¾ã™ã€‚

1. VS Code ã§ **`register-commands.js`** ã‚’æ–°è¦ä½œæˆã—ã¾ã™

2. æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ **ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜**ã—ã¦ãã ã•ã„  
   ï¼ˆâ€»ã“ã® `commands` ã¯ã€æ¬¡ã®ç« ã§ **ç½®ãæ›ãˆã¾ã™**ï¼‰

```js
require('dotenv').config();
const { REST, Routes } = require('discord.js');

// â€»ã“ã®é…åˆ—ã¯ã€æ¬¡ã®ç« ã§å†…å®¹ã‚’ç½®ãæ›ãˆã¾ã™
const commands = [
  {
    name: 'hello',
    description: 'æŒ¨æ‹¶ã—ã¾ã™'
  }
];

const rest = new REST({ version: '10' }).setToken(process.env.DISCORD_TOKEN);

(async () => {
  try {
    console.log('ã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²ä¸­...');
    
    await rest.put(
      await rest.put(
  Routes.applicationGuildCommands(
    process.env.CLIENT_ID,
    process.env.GUILD_ID
  ),
  { body: commands }
);
,
      { body: commands }
    );
    
    console.log('ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²å®Œäº†ï¼');
  } catch (error) {
    console.error(error);
  }
})();
````

---

### 4-2. CLIENT_ID ã¨ GUILD_ID ã‚’ .env ã«è¿½åŠ 

#### 4-2-1. CLIENT_IDï¼ˆApplication IDï¼‰ã‚’å–å¾—ã—ã¦ .env ã«è¿½åŠ 

1. [Discord Developer Portal](https://discord.com/developers/applications) ã«æˆ»ã‚‹
2. ä½œæˆã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **General Information** â†’ **APPLICATION ID** ã‚’ã‚³ãƒ”ãƒ¼
4. `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ï¼š

```bash
DISCORD_TOKEN=ã‚ãªãŸã®ãƒˆãƒ¼ã‚¯ãƒ³
CLIENT_ID=ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ID
```

---

#### 4-2-2. GUILD_IDï¼ˆã‚µãƒ¼ãƒãƒ¼IDï¼‰ã‚’å–å¾—ã—ã¦ .env ã«è¿½åŠ ï¼ˆé–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ãŒå¿…è¦ï¼‰

> âš ï¸ ã‚µãƒ¼ãƒãƒ¼IDï¼ˆGUILD_IDï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã«ã¯ã€Discordã® **é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰** ã‚’ONã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

##### A) Discordã§é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹

**Discordã‚¢ãƒ—ãƒªï¼ˆPCï¼‰ã§ï¼š**

1. Discordã‚’é–‹ã
2. å·¦ä¸‹ã® âš™ï¸ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯
3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ **è©³ç´°è¨­å®šï¼ˆAdvancedï¼‰** ã‚’é–‹ã
4. **é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ï¼ˆDeveloper Modeï¼‰** ã‚’ **ON** ã«ã™ã‚‹

##### B) ã‚µãƒ¼ãƒãƒ¼IDï¼ˆGUILD_IDï¼‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹

1. `GUILD_ID` ã‚’è¨­å®šã—ãŸã„ **ã‚µãƒ¼ãƒãƒ¼ï¼ˆã‚®ãƒ«ãƒ‰ï¼‰** ã‚’é–‹ã
2. ã‚µãƒ¼ãƒãƒ¼åï¼ˆå·¦ä¸Šï¼‰ã‚’ **å³ã‚¯ãƒªãƒƒã‚¯**
3. è¡¨ç¤ºã•ã‚ŒãŸãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ä¸€ç•ªä¸‹ä»˜è¿‘ã«ã‚ã‚‹ **ã€ŒID ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆCopy IDï¼‰ã€** ã‚’ã‚¯ãƒªãƒƒã‚¯

   * ã“ã‚ŒãŒ **GUILD_ID** ã§ã™ï¼ˆæ•°å­—ã ã‘ã®é•·ã„IDï¼‰

##### C) `.env` ã« GUILD_ID ã‚’è¿½è¨˜ã™ã‚‹

`.env` ã‚’æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ï¼š

```bash
DISCORD_TOKEN=ã‚ãªãŸã®ãƒˆãƒ¼ã‚¯ãƒ³
CLIENT_ID=ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ID
GUILD_ID=ã‚ãªãŸã®ã‚µãƒ¼ãƒãƒ¼ID
```

---

âœ… **ãƒã‚¤ãƒ³ãƒˆ**

* `CLIENT_ID` ã¯ Developer Portal ã® **APPLICATION ID**
* `GUILD_ID` ã¯ Discordã‚¢ãƒ—ãƒªã§ã‚³ãƒ”ãƒ¼ã™ã‚‹ **ã‚µãƒ¼ãƒãƒ¼ID**
* ã©ã¡ã‚‰ã‚‚ **æ•°å­—ã ã‘**ï¼ˆå¼•ç”¨ç¬¦ã‚„ä½™è¨ˆãªç©ºç™½ãªã—ï¼‰ã§å…¥ã‚Œã‚‹ã®ãŒå®‰å…¨ã§ã™


---

### 4-3. ã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²

```bash
node register-commands.js
```

**æˆåŠŸã™ã‚‹ã¨ï¼š**
```
ã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²ä¸­...
ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²å®Œäº†ï¼
```

---

### 4-4. index.js ã«ã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã‚’è¿½åŠ 

`index.js` ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ï¼š

```javascript
require('dotenv').config();
const { Client, GatewayIntentBits } = require('discord.js');

const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ]
});

client.once('ready', () => {
  console.log(`${client.user.tag} ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼`);
});

// ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚ŒãŸã¨ãã®å‡¦ç†
client.on('interactionCreate', async interaction => {
  if (!interaction.isChatInputCommand()) return;

  if (interaction.commandName === 'hello') {
    await interaction.reply('ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã† ğŸ˜Š');
  }
});

client.login(process.env.DISCORD_TOKEN);
```

---

### 4-5. Bot ã‚’å†èµ·å‹•ã—ã¦ç¢ºèª

```bash
node index.js
```

Discord ã‚µãƒ¼ãƒãƒ¼ã§ `/hello` ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

**âœ… Bot ãŒè¿”ä¿¡ã™ã‚Œã°æˆåŠŸã§ã™ï¼**

---

## ç¬¬5ç« ï¼šSQLite ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ï¼ˆ20åˆ†ï¼‰
äº†è§£ã§ã™ã€‚
**æ”¹å–„æ¡ˆâ‘ ï¼ˆç½®ãæ›ãˆã‚’æ˜ç¤ºã™ã‚‹ç‰ˆï¼‰**ã¨ã—ã¦ã€
ãã®ã¾ã¾æ•™æã«è²¼ã‚Œã‚‹ **è©²å½“éƒ¨åˆ†ã ã‘ã® Markdown** ã‚’ä½œã‚Šã¾ã™ã€‚

---

## 5-1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åˆæœŸåŒ–ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼ˆé‡è¦ï¼‰

> âš ï¸ ã“ã®ç« ã§ã¯ **index.js ã®å…ˆé ­éƒ¨åˆ†ã‚’ã€Œè¿½åŠ ã€ã§ã¯ãªãã€Œç½®ãæ›ãˆã€ã¾ã™**  
> `Client` ã‚’ä½œæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒ **2å›æ›¸ã‹ã‚Œãªã„ã‚ˆã†ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

### æ‰‹é †

1. `index.js` ã‚’é–‹ã

2. ã™ã§ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’ **æ¢ã—ã¦å‰Šé™¤** ã—ã¾ã™

```js
require('dotenv').config();
const { Client, GatewayIntentBits } = require('discord.js');

const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ]
});
````

3. ä»£ã‚ã‚Šã«ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«** æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™

```js
require('dotenv').config();
const { Client, GatewayIntentBits } = require('discord.js');
const Database = require('better-sqlite3');

// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
const db = new Database('bot.db');

// ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãªã‘ã‚Œã°ä½œæˆ
db.exec(`
  CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )
`);

console.log('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™å®Œäº†');

// Discord ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆï¼ˆâ€»ã“ã“ã¯1å›ã ã‘ï¼‰
const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ]
});
```

4. ã“ã®ã‚³ãƒ¼ãƒ‰ã® **ä¸‹ã«**ã€ã“ã‚Œã¾ã§æ›¸ã„ã¦ããŸæ—¢å­˜ã®å‡¦ç†
   ï¼ˆ`ready` / `interactionCreate` / `client.login` ãªã©ï¼‰ã‚’
   **ãã®ã¾ã¾æ®‹ã—ã¦ãã ã•ã„**

---

### âœ… ãƒã‚¤ãƒ³ãƒˆ

* `require('discord.js')` ã‚„ `new Client(...)` ã¯ **1ãƒ•ã‚¡ã‚¤ãƒ«ã«1å›ã ã‘**
* ã€Œè²¼ã‚Šè¶³ã™ã€ã®ã§ã¯ãªã **å…ˆé ­éƒ¨åˆ†ã‚’å·®ã—æ›¿ãˆã‚‹** ä½œæ¥­ã§ã™

---

## 5-2. `/save` ã¨ `/read` ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ 

> âš ï¸ ã“ã®ç« ã§ã¯ **`commands` ã®é…åˆ—ã‚’ã€Œè¿½è¨˜ã€ã§ã¯ãªãã€Œç½®ãæ›ãˆã€ã¾ã™**
> `const commands = ...` ãŒ **2å›æ›¸ã‹ã‚Œãªã„ã‚ˆã†ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

1. `register-commands.js` ã‚’é–‹ã

2. ã™ã§ã«ã‚ã‚‹ `const commands = [...]` ã‚’ **ã™ã¹ã¦å‰Šé™¤**ã—ã¾ã™

3. ä»£ã‚ã‚Šã«ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ **åŒã˜ä½ç½®ã«è²¼ã‚Šä»˜ã‘ã¾ã™**

```js
const commands = [
  {
    name: 'hello',
    description: 'æŒ¨æ‹¶ã—ã¾ã™'
  },
  {
    name: 'save',
    description: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã—ã¾ã™',
    options: [
      {
        name: 'message',
        description: 'ä¿å­˜ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
        type: 3, // STRINGå‹
        required: true
      }
    ]
  },
  {
    name: 'read',
    description: 'æœ€å¾Œã«ä¿å­˜ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿å‡ºã—ã¾ã™'
  }
];
```

4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¾ã™

---

### âœ… ãƒã‚¤ãƒ³ãƒˆ

* `const commands = [...]` ã¯ **1ãƒ•ã‚¡ã‚¤ãƒ«ã«1å›ã ã‘**
* æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã¯ **ã€Œé…åˆ—ã‚’å·®ã—æ›¿ãˆã‚‹ã€** å½¢ã§è¿½åŠ ã—ã¾ã™

---

**ã‚³ãƒãƒ³ãƒ‰ã‚’å†ç™»éŒ²ï¼š**
```bash
node register-commands.js
```

---

### 5-3. index.js ã«ä¿å­˜ãƒ»èª­ã¿å‡ºã—å‡¦ç†ã‚’è¿½åŠ 

`client.on('interactionCreate', ...)` ã®éƒ¨åˆ†ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ï¼š

```javascript
client.on('interactionCreate', async interaction => {
  if (!interaction.isChatInputCommand()) return;

  if (interaction.commandName === 'hello') {
    await interaction.reply('ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã† ğŸ˜Š');
  }

  if (interaction.commandName === 'save') {
    const message = interaction.options.getString('message');
    const userId = interaction.user.id;

    // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    const stmt = db.prepare('INSERT INTO messages (user_id, content) VALUES (?, ?)');
    stmt.run(userId, message);

    await interaction.reply('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ ğŸ“');
  }

  if (interaction.commandName === 'read') {
    const userId = interaction.user.id;

    // æœ€æ–°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
    const stmt = db.prepare('SELECT content FROM messages WHERE user_id = ? ORDER BY created_at DESC LIMIT 1');
    const row = stmt.get(userId);

    if (row) {
      await interaction.reply(`è¨˜éŒ²ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${row.content}`);
    } else {
      await interaction.reply('ã¾ã ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
  }
});
```

---

### 5-4. å‹•ä½œç¢ºèª

```bash
node index.js
```

Discord ã‚µãƒ¼ãƒãƒ¼ã§è©¦ã—ã¦ãã ã•ã„ï¼š

```
/save message:ãŠã¯ã‚ˆã†
â†’ Bot: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ ğŸ“

/read
â†’ Bot: è¨˜éŒ²ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ãŠã¯ã‚ˆã†
```

**âœ… ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ãƒ»èª­ã¿å‡ºã—ã§ãã‚Œã°æˆåŠŸã§ã™ï¼**

---

## ç¬¬6ç« ï¼šGit ã§è¨˜éŒ²ï¼ˆ5åˆ†ï¼‰

### 6-1. .gitignore ã‚’ç¢ºèª

`bot.db` ã‚‚ Git ã«å«ã‚ãªã„ã‚ˆã†ã«ã—ã¾ã™ï¼š

```bash
echo bot.db >> .gitignore
echo "*.db" >> .gitignore
```

---

### 6-2. ã‚³ãƒŸãƒƒãƒˆ

```bash
git add .
git commit -m "ç¬¬3å›: Botåˆå°å…¥+SQLiteåŸºç¤"
git push
```

---

## âœ… ã“ã®å›ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Discord Bot ã‚’ã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…ã§ããŸ
- [ ] `/hello` ã‚³ãƒãƒ³ãƒ‰ã§ Bot ãŒåå¿œã—ãŸ
- [ ] `/save` ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã§ããŸ
- [ ] `/read` ã§ä¿å­˜ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿å‡ºã›ãŸ
- [ ] `bot.db` ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸ
- [ ] Git ã«ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥ã§ããŸ

---

## ğŸ” ä»Šæ—¥è¦šãˆã‚‹ã“ã¨

### Discord Bot ã®åŸºæœ¬

- Bot ã¯ `index.js` ã§èµ·å‹•ã™ã‚‹
- `node index.js` ã§å‹•ã‹ã™
- `Ctrl + C` ã§åœæ­¢ã™ã‚‹

### SQLite ã®åŸºæœ¬

- `better-sqlite3` ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã†
- `INSERT` ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
- `SELECT` ã§ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å‡ºã—

### ç’°å¢ƒå¤‰æ•°

- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§˜å¯†æƒ…å ±ã‚’ä¿å­˜
- `.gitignore` ã§ Git ã‹ã‚‰é™¤å¤–

---

## âš ï¸ ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«

### Bot ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«ãªã‚‰ãªã„

**åŸå› ï¼š** ãƒˆãƒ¼ã‚¯ãƒ³ãŒé–“é•ã£ã¦ã„ã‚‹

**å¯¾å‡¦æ³•ï¼š**
1. `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã® `DISCORD_TOKEN` ã‚’ç¢ºèª
2. Developer Portal ã§æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
3. `.env` ã‚’æ›´æ–°ã—ã¦å†èµ·å‹•

---

### /hello ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› ï¼š** ã‚³ãƒãƒ³ãƒ‰ãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„

**å¯¾å‡¦æ³•ï¼š**
```bash
node register-commands.js
```

---

### ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œãªã„

**åŸå› ï¼š** ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„

**å¯¾å‡¦æ³•ï¼š**
1. `index.js` ã®å…ˆé ­ã« `db.exec(...)` ãŒã‚ã‚‹ã‹ç¢ºèª
2. Bot ã‚’å†èµ·å‹•

---

## ğŸ“– å‚è€ƒè³‡æ–™

- [discord.js å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://discord.js.org/)
- [better-sqlite3 å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/WiseLibs/better-sqlite3)

---

## æ¬¡å›äºˆå‘Š

### ç¬¬4å›ï¼šSQLiteä¿å­˜ï¼‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã‚€(/count)

ã“ã“ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteï¼‰ã®æº–å‚™ã‚’ã™ã‚‹å ´æ‰€ã§ã™ã€‚  
`index.js` ã®ä¸Šã®ã»ã†ã«ã‚ã‚‹ `const db = new Database(...)` ã¨ `db.exec(` ãŒä¸¦ã‚“ã§ã„ã‚‹ã‚ãŸã‚Šã‚’æ¢ã—ã¦ãã ã•ã„ã€‚  
ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã‚„åˆæœŸåŒ–ã®ã‚³ãƒ¼ãƒ‰ã¯ã€åŸºæœ¬çš„ã«ã“ã® **DBæº–å‚™ã®ã‹ãŸã¾ã‚Šã®ä¸­**ã«ç½®ãã¾ã™ã€‚


ä»Šå›ã¯ã€Œ1ã¤ã ã‘ä¿å­˜ãƒ»èª­ã¿å‡ºã—ã€ã§ã—ãŸãŒã€æ¬¡å›ã¯ï¼š
- è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†
- ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…
- ãƒ‡ãƒ¼ã‚¿ã®é›†è¨ˆã‚’å­¦ã¶

**ğŸ‘‰ ãƒ¡ãƒ³ã‚¿ãƒ«ç³» Bot ã‚‰ã—ã„æ©Ÿèƒ½ã‚’ä½œã‚Šå§‹ã‚ã¾ã™ï¼**
---

## ğŸ“¦ ã“ã®å›ã®å®Œæˆç‰ˆã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
git_practice/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .env
â”œâ”€â”€ .env.example
â”œâ”€â”€ package.json
â”œâ”€â”€ index.js
â””â”€â”€ register-commands.js
```

---

### index.js
```javascript
// .env ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚€
require('dotenv').config();
const { Client, GatewayIntentBits } = require('discord.js');
const Database = require('better-sqlite3');

// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
const db = new Database('bot.db');

// ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãªã‘ã‚Œã°ä½œæˆ
db.exec(`
  CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )
`);

console.log('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™å®Œäº†');

// Bot ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆ
const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent
  ]
});

// Bot ãŒèµ·å‹•ã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹
client.once('ready', () => {
  console.log(`${client.user.tag} ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸï¼`);
});

// ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚ŒãŸã¨ãã®å‡¦ç†
client.on('interactionCreate', async interaction => {
  if (!interaction.isChatInputCommand()) return;

  if (interaction.commandName === 'hello') {
    await interaction.reply('ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã† ğŸ˜Š');
  }

  if (interaction.commandName === 'save') {
    const message = interaction.options.getString('message');
    const userId = interaction.user.id;

    // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    const stmt = db.prepare('INSERT INTO messages (user_id, content) VALUES (?, ?)');
    stmt.run(userId, message);

    await interaction.reply('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ ğŸ“');
  }

  if (interaction.commandName === 'read') {
    const userId = interaction.user.id;

    // æœ€æ–°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
    const stmt = db.prepare('SELECT content FROM messages WHERE user_id = ? ORDER BY created_at DESC LIMIT 1');
    const row = stmt.get(userId);

    if (row) {
      await interaction.reply(`è¨˜éŒ²ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${row.content}`);
    } else {
      await interaction.reply('ã¾ã ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
  }
});

// Discord ã«ãƒ­ã‚°ã‚¤ãƒ³
client.login(process.env.DISCORD_TOKEN);
```

---

### register-commands.js
```javascript
require('dotenv').config();
const { REST, Routes } = require('discord.js');

const commands = [
  {
    name: 'hello',
    description: 'æŒ¨æ‹¶ã—ã¾ã™'
  },
  {
    name: 'save',
    description: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã—ã¾ã™',
    options: [
      {
        name: 'message',
        description: 'ä¿å­˜ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
        type: 3, // STRINGå‹
        required: true
      }
    ]
  },
  {
    name: 'read',
    description: 'æœ€å¾Œã«ä¿å­˜ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿å‡ºã—ã¾ã™'
  }
];

const rest = new REST({ version: '10' }).setToken(process.env.DISCORD_TOKEN);

(async () => {
  try {
    console.log('ã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²ä¸­...');
    
    await rest.put(
      Routes.applicationGuildCommands(
        process.env.CLIENT_ID,
        process.env.GUILD_ID
      ),
      { body: commands }
    );
    
    console.log('ã‚³ãƒãƒ³ãƒ‰ç™»éŒ²å®Œäº†ï¼');
  } catch (error) {
    console.error(error);
  }
})();
```

---

### .env.example
```
DISCORD_TOKEN=ã‚ãªãŸã®ãƒˆãƒ¼ã‚¯ãƒ³
CLIENT_ID=ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ID
GUILD_ID=ã‚ãªãŸã®ã‚µãƒ¼ãƒãƒ¼ID
```

**æ³¨æ„ï¼š** å®Ÿéš›ã«ä½¿ã† `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `.env.example` ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆã—ã€å®Ÿéš›ã®å€¤ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚

---

### .gitignore
```
node_modules
.env
bot.db
*.db
```

---

### package.json
```json
{
  "name": "git_practice",
  "version": "1.0.0",
  "description": "Discord Bot ãƒãƒ³ã‚ºã‚ªãƒ³",
  "main": "index.js",
  "scripts": {
    "start": "node index.js"
  },
  "dependencies": {
    "discord.js": "^14.14.1",
    "better-sqlite3": "^9.2.2",
    "dotenv": "^16.3.1"
  }
}
```

**ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ï¼š**
```bash
npm install
```

ã“ã‚Œã§ç¬¬3å›ã¯å®Œæˆã§ã™ï¼

