# 第15回：やらかした時に「直さない」選択をする

―― 修正より、被害を止める ――

ログを見た。
どこが悪いかも、だいたい分かった。

でも──
**今すぐ直せない。**

この状況、現場では珍しくありません。

この回では、
**「正しい修正」ではなく「正しい判断」**をします。

---

## 📌 この回の目標

* 「直す以外の選択肢」を実際に使う
* ロールバック・停止・放置を**判断として選べる**
* 本番対応で **パニックにならない** 状態を作る

**💡 この回の約束**

* バグ修正しない
* 原因を深掘りしない
* きれいに直さない

👉 **被害を止める**ことだけをやります。

---

## 🎯 完成イメージ

```
【Before】
不具合発生
→ 慌てて修正
→ さらに壊す
→ 夜が終わる

【After】
不具合発生
→ 状況を確認
→ 直さない判断
→ 元に戻す／止める
→ 被害が止まる
```

---

## 第1章：「直す」は一番リスクが高い（10分）

### 1-1. なぜ“直そう”とすると事故るのか

本番での修正には、必ずこれが含まれます：

* 焦り
* 情報不足
* テスト不足

つまり、

> **一番危険な状態で、一番危険な作業をする**

---

### 1-2. 現場で使われる選択肢は3つだけ

不具合が起きたとき、
実際に選ばれる行動はこの3つです。

```
① 元に戻す（ロールバック）
② 一時的に止める
③ 何もしない（放置）
```

**「その場で直す」**は、
実は**最優先ではありません**。

---

## 第2章：今回使う3つの判断（15分）

### ① 元に戻す（ロールバック）

**使う場面**

* 直前の変更が原因
* 1つ前の状態は安定していた

**やること**

```bash
git log --oneline
git checkout <ひとつ前のコミット>
pm2 reload discord-bot
```

**結果**

* 新機能は消える
* でも Bot は動く

👉 **一番よく使う判断**

---

### ② 一時的に止める

**使う場面**

* 被害が広がっている
* データが壊れそう
* 原因が全く分からない

**やること**

```bash
pm2 stop discord-bot
```

**結果**

* ユーザーは使えない
* でも被害は止まる

👉 **勇気がいるが、正しい判断**

---

### ③ 何もしない（放置）

**使う場面**

* 軽微な不具合
* 管理者しか影響を受けない
* 今は対応できない

**やること**

* 何もしない
* 記録だけ残す

👉 **これも立派な判断**

---

## 第3章：わざと不具合を入れる（20分）

### 3-1. 不具合を仕込む

以下のどれかを**わざと**やります：

* コマンド処理の return を消す
* DB パスを間違える
* 存在しない環境変数を読む

例：

```js
const dbPath = process.env.DB_PATH; // 本当は DATABASE_PATH
```

---

### 3-2. デプロイする

```bash
./deploy.sh
```

---

### 3-3. 症状を確認

* Bot が起動しない
* コマンドに反応しない
* ログにエラーが出る

👉 **ここで修正しない**

---

## 第4章：「直さない」判断を実行する（20分）

### パターンA：ロールバックする

```bash
git log --oneline
git checkout HEAD~1
pm2 reload discord-bot
pm2 logs discord-bot
```

**確認**

* Bot が元通り動く
* 新機能は消えている

---

### パターンB：止める

```bash
pm2 stop discord-bot
pm2 status
```

**確認**

* Bot は完全に止まる
* エラーは出ない

---

### パターンC：放置する

**やること**

* 何もしない
* README / issue / メモに状況を書く

例：

```markdown
## 2026-02-xx 障害メモ

- 症状：/export コマンドでエラー
- 影響範囲：管理者のみ
- 対応：本日は放置
- 理由：本番影響が小さいため
```

---

## 第5章：この回で一番大事な判断（10分）

### 5-1. 自分に聞く3つの質問

* 今、**誰が困っている？**
* 放置すると **被害は広がる？**
* 今日中に直す **価値がある？**

---

### 5-2. この回の結論

> **直さない判断は、逃げではない**
> **被害を止めるための技術**

---

## 第6章：この回でやらないこと（重要）

* 根本原因の解消
* きれいな修正
* ベストプラクティス探し

👉 それは **次のフェーズ**。

---

## ✅ この回のチェックリスト

* [ ] ロールバックを実行した
* [ ] pm2 stop を使った
* [ ] 「放置」という判断を理解した
* [ ] 直さないことへの罪悪感が減った
* [ ] 判断を言語化できた

---

## 🎓 この回で得たもの

* 本番対応の現実感
* 「直せない自分」を責めなくなる
* 被害を最小にする視点

> **開発者の仕事は、
> いつもコードを書くことではない**

---

## 📝 次回予告

**第16回：DB設計を“変える”判断をする**

次は、

* 壊したら怖い
* 触りたくない

DB を **実際に変えます**。

「設計が怖い」感覚を、
ハンズオンで越えます。