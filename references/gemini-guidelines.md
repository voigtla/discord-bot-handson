# Gemini API 使用ガイドライン（メンタル系Bot用）

このドキュメントは、メンタル系サーバーでGemini APIを使う際の「線引き」を明確にするためのものです。

---

## 基本原則

> **LLMは「補助」であり、「判断」させない**

- Botは寄り添うもの
- 診断や評価はしない
- 選択肢を増やすことはあっても、減らさない

---

## ⭕ やっていいこと

### 1. 要約
```javascript
// ユーザーの過去のチェックイン内容を要約
"最近3回のチェックイン: 疲れている、眠い、やる気が出ない"
  ↓
"最近は疲れを感じることが多いようですね"
```

**理由:** 情報を整理するだけで、判断はしていない

---

### 2. 言い換え
```javascript
// ユーザーの入力を優しい言葉に変換
"もうダメだ" 
  ↓
"つらい気持ちなんですね"
```

**理由:** 共感を示すだけで、評価はしていない

---

### 3. 共感表現生成
```javascript
// 状況に応じた共感の言葉を生成
"今日は5時間しか寝られなかった"
  ↓
"5時間睡眠はきついですね。お疲れさまです"
```

**理由:** 事実を受け止めるだけ

---

### 4. 選択肢の提示
```javascript
// 次のアクションの選択肢を提示
"何もしたくない"
  ↓
"そういう日もありますよね。
 - 少し休む
 - 音楽を聴く
 - そのまま寝る
 どれでも、どれでなくてもいいですよ"
```

**理由:** 選択肢を増やしているだけで、強制していない

---

## ❌ やってはいけないこと

### 1. 診断
```javascript
// NG例
"あなたは鬱の可能性があります"
"○○症候群の傾向が見られます"
```

**理由:** 医療行為に該当する可能性がある

---

### 2. 判断・評価
```javascript
// NG例
"それは良くないですね"
"その考え方は間違っています"
"もっと前向きになるべきです"
```

**理由:** ユーザーを否定する

---

### 3. アドバイス・指示
```javascript
// NG例
"運動をすれば治ります"
"早く寝るようにしてください"
"病院に行くべきです"
```

**理由:** 専門家ではない立場で指導している

---

### 4. 比較・ランク付け
```javascript
// NG例
"前回よりも悪化していますね"
"先週の方が良かったです"
```

**理由:** 状態を評価している

---

### 5. 予測・将来の保証
```javascript
// NG例
"このままだと悪化します"
"続ければ必ず良くなります"
```

**理由:** 根拠のない断定

---

## ⚠️ 慎重に扱うこと

### 1. 履歴の要約

**問題点:**
- 長期間の履歴を要約すると「診断っぽく」見える
- パターンの指摘が評価になる

**対策:**
```javascript
// ⭕ OK
"最近3日間のチェックイン内容をまとめました"

// ❌ NG
"あなたの傾向として、月曜日に調子が悪くなる傾向があります"
```

---

### 2. パターン検出

**問題点:**
- 「傾向」の指摘が診断に見える

**対策:**
```javascript
// ⭕ OK
"月曜日のチェックイン: 疲れている（記録）"

// ❌ NG
"月曜日は精神的に不安定になる傾向があります（解釈）"
```

---

### 3. 感情の読み取り

**問題点:**
- 「あなたは○○と感じている」という断定

**対策:**
```javascript
// ⭕ OK
"つらそうに見えますね"（観察）

// ❌ NG
"あなたは深刻な悩みを抱えています"（断定）
```

---

## 実装時のチェックリスト

Gemini APIを呼ぶ前に、以下を確認：

- [ ] ユーザーを評価していないか？
- [ ] 診断・判断をしていないか？
- [ ] アドバイス・指示をしていないか？
- [ ] 将来を予測していないか？
- [ ] 選択肢を減らしていないか？

**1つでもチェックが入ったら、実装を見直す**

---

## プロンプト設計のコツ

### ⭕ 良いプロンプト例

```javascript
const prompt = `
以下のユーザーの入力を、優しい言葉で言い換えてください。
評価や判断はせず、共感を示すだけにしてください。

入力: ${userInput}
`;
```

**ポイント:**
- 「評価や判断はせず」と明示
- 具体的な指示（「言い換え」「共感」）

---

### ❌ 悪いプロンプト例

```javascript
const prompt = `
以下のユーザーの状態を分析し、適切なアドバイスをしてください。

入力: ${userInput}
`;
```

**問題点:**
- 「分析」→ 評価・判断
- 「適切なアドバイス」→ 指示

---

## エラーケース

### ケース1: Gemini APIが診断的な返答をした

**対策:**
- プロンプトに「診断しないでください」を追加
- または、その出力を使わない

```javascript
if (response.includes('診断') || response.includes('症状')) {
  // この返答は使わない
  return "ごめんなさい、うまく返答できませんでした";
}
```

---

### ケース2: ユーザーが診断を求めてきた

```
ユーザー: 「私って鬱ですか？」
```

**対応:**
```javascript
// Gemini APIに投げない
return "専門家ではないので、診断はできません。気になる場合は、専門機関への相談をおすすめします";
```

---

## ログ・履歴の扱い

### 保存していいもの
- ユーザーの入力（チェックイン内容）
- Botの返答
- タイムスタンプ

### 保存してはいけないもの
- 「診断結果」のようなラベル
- ユーザーの「状態」を評価したメタデータ
- 他のユーザーとの比較データ

---

## 定期的な見直し

このガイドラインは、以下のタイミングで見直す：

1. 新しい機能を追加するとき
2. ユーザーから懸念が寄せられたとき
3. 3ヶ月に1回（定期）

---

## 参考資料

- [Gemini API公式ドキュメント](https://ai.google.dev/docs)
- メンタルヘルス系Botの倫理ガイドライン（作成予定）

---

## 更新履歴

- 2025/01/XX: 初版作成
